webpackJsonp([36],{"9GoY":function(t,e){},ZQBm:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n,o,s=i("Dd8w"),a=i.n(s),l=i("NYxO"),h=i("QLyc"),c=i("BMSc"),u=i("vQO2"),d=i("Ml+6"),p={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function m(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(m.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),m.FullScreenQuad=(r=new d.W(-1,1,1,-1,0,1),n=new d.Y(2,2),o=function(t){this._mesh=new d.L(n,t)},Object.defineProperty(o.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(o.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,r)}}),o);var f=function(t,e){m.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof d._7?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=d._21.clone(t.uniforms),this.material=new d._7({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new m.FullScreenQuad(this.material)};f.prototype=Object.assign(Object.create(m.prototype),{constructor:f,render:function(t,e,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}});var v=function(t,e){m.call(this),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1};v.prototype=Object.assign(Object.create(m.prototype),{constructor:v,render:function(t,e,i){var r,n,o=t.getContext(),s=t.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(r=0,n=1):(r=1,n=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),s.buffers.stencil.setFunc(o.ALWAYS,r,4294967295),s.buffers.stencil.setClear(n),s.buffers.stencil.setLocked(!0),t.setRenderTarget(i),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(o.EQUAL,1,4294967295),s.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),s.buffers.stencil.setLocked(!0)}});var w=function(){m.call(this),this.needsSwap=!1};w.prototype=Object.create(m.prototype),Object.assign(w.prototype,{render:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}});var g=function(t,e){if(this.renderer=t,void 0===e){var i={minFilter:d.F,magFilter:d.F,format:d._3,stencilBuffer:!1},r=t.getSize(new d._22);this._pixelRatio=t.getPixelRatio(),this._width=r.width,this._height=r.height,(e=new d._26(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=e.width,this._height=e.height;this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===p&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===f&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new f(p),this.clock=new d.k};Object.assign(g.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,e){this.passes.splice(e,0,t)},isLastEnabledPass:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0},render:function(t){void 0===t&&(t=this.clock.getDelta());var e,i,r=this.renderer.getRenderTarget(),n=!1,o=this.passes.length;for(i=0;i<o;i++)if(!1!==(e=this.passes[i]).enabled){if(e.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),e.render(this.renderer,this.writeBuffer,this.readBuffer,t,n),e.needsSwap){if(n){var s=this.renderer.getContext(),a=this.renderer.state.buffers.stencil;a.setFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),a.setFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==v&&(e instanceof v?n=!0:e instanceof w&&(n=!1))}this.renderer.setRenderTarget(r)},reset:function(t){if(void 0===t){var e=this.renderer.getSize(new d._22);this._pixelRatio=this.renderer.getPixelRatio(),this._width=e.width,this._height=e.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this._width=t,this._height=e;var i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(var n=0;n<this.passes.length;n++)this.passes[n].setSize(i,r)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var b=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(b.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),b.FullScreenQuad=function(){var t=new d.W(-1,1,1,-1,0,1),e=new d.Y(2,2),i=function(t){this._mesh=new d.L(e,t)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(e){e.render(this._mesh,t)}}),i}();var y=function(t,e,i,r,n){m.call(this),this.scene=t,this.camera=e,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=void 0!==n?n:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};y.prototype=Object.assign(Object.create(m.prototype),{constructor:y,render:function(t,e,i){var r,n,o=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(r=t.getClearColor().getHex(),n=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(r,n),this.scene.overrideMaterial=null,t.autoClear=o}});var x={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new d.l(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},M=function(t,e,i,r){m.call(this),this.strength=void 0!==e?e:1,this.radius=i,this.threshold=r,this.resolution=void 0!==t?new d._22(t.x,t.y):new d._22(256,256),this.clearColor=new d.l(0,0,0);var n={minFilter:d.F,magFilter:d.F,format:d._3};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);this.renderTargetBright=new d._26(o,s,n),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var a=0;a<this.nMips;a++){var l=new d._26(o,s,n);l.texture.name="UnrealBloomPass.h"+a,l.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(l);var h=new d._26(o,s,n);h.texture.name="UnrealBloomPass.v"+a,h.texture.generateMipmaps=!1,this.renderTargetsVertical.push(h),o=Math.round(o/2),s=Math.round(s/2)}void 0===x&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var c=x;this.highPassUniforms=d._21.clone(c.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new d._7({uniforms:this.highPassUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var u=[3,5,7,9,11];for(o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2),a=0;a<this.nMips;a++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(u[a])),this.separableBlurMaterials[a].uniforms.texSize.value=new d._22(o,s),o=Math.round(o/2),s=Math.round(s/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=e,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new d._23(1,1,1),new d._23(1,1,1),new d._23(1,1,1),new d._23(1,1,1),new d._23(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===p&&console.error("UnrealBloomPass relies on CopyShader");var f=p;this.copyUniforms=d._21.clone(f.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new d._7({uniforms:this.copyUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:d.b,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new d.l,this.oldClearAlpha=1,this.basic=new d.M,this.fsQuad=new m.FullScreenQuad(null)};M.prototype=Object.assign(Object.create(m.prototype),{constructor:M,dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,e){var i=Math.round(t/2),r=Math.round(e/2);this.renderTargetBright.setSize(i,r);for(var n=0;n<this.nMips;n++)this.renderTargetsHorizontal[n].setSize(i,r),this.renderTargetsVertical[n].setSize(i,r),this.separableBlurMaterials[n].uniforms.texSize.value=new d._22(i,r),i=Math.round(i/2),r=Math.round(r/2)},render:function(t,e,i,r,n){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var o=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),n&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t);for(var s=this.renderTargetBright,a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[a].uniforms.direction.value=M.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[a]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=M.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[a]),t.clear(),this.fsQuad.render(t),s=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,n&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(i),this.fsQuad.render(t)),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o},getSeperableBlurMaterial:function(t){return new d._7({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new d._22(.5,.5)},direction:{value:new d._22(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(t){return new d._7({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),M.BlurDirectionX=new d._22(1,0),M.BlurDirectionY=new d._22(0,1);var S=i("AkSr"),T={data:function(){var t=new THREE.WebGLRenderer({antialias:!0}),e=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4),i=new THREE.Scene;return{renderer:t,scene:i,renderScene:new y(i,e),camera:e,stats:new h.a,raycaster:new THREE.Raycaster,mouse:new THREE.Vector2,bloomPass:new M(new THREE.Vector2(window.innerWidth,window.innerHeight),1.5,.4,.85),composer:new g(t),showUpdateTranformControls:!1,lightBox:{ambientLight:new THREE.AmbientLight("rgb(255, 255, 255)",1)},helperBox:{axesHelper:new THREE.AxesHelper(1e4),gridHelper:new THREE.GridHelper(1500,30,"white","rgb(150, 150, 150)")},objectSetting:{planeTotal:50,sphereTotal:500,r1:60,r2:100,maxY:1200,minY:-1200,planSetting:{minWidth:30,minHeight:700,maxWidth:50,maxHeight:1e3},sphereSetting:{scaleMax:30,scaleMin:15}},cameraDirection:1,clock:new THREE.Clock,orbitControls:new c.a(e,t.domElement),transformControls:new u.a(e,t.domElement),animationControl:!0,animationSpeed:1,animationFrame:""}},methods:a()({init:function(){this.initRender(),this.initCamera(),this.initBloomPass(),this.initComposer(),this.initLight(),this.initHelper(),this.initStats(),this.initOrbitControls(),this.initObject(),this.initGui(),this.updateRenderer()},initRender:function(){this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.toneMapping=THREE.ReinhardToneMapping,this.renderer.toneMappingExposure=Math.pow(1.2,4),this.$refs["three-canvas"].appendChild(this.renderer.domElement),this.renderer.setClearColor("rgb(0, 0, 0)")},initComposer:function(){this.composer=new g(this.renderer),this.composer.addPass(this.renderScene),this.composer.addPass(this.bloomPass)},initBloomPass:function(){this.bloomPass.threshold=0,this.bloomPass.strength=1.2,this.bloomPass.radius=.3},initLight:function(){this.scene.add(this.lightBox.ambientLight)},initCamera:function(){this.camera.position.x=0,this.camera.position.y=2e3,this.camera.position.z=0,this.camera.up.x=0,this.camera.up.y=1,this.camera.up.z=0,this.camera.lookAt(new THREE.Vector3(0,0,0))},initHelper:function(){},initStats:function(){this.stats=new h.a,this.stats.setMode(0),this.stats.domElement.id="three-stats",this.stats.domElement.style.position="absolute",this.stats.domElement.style.left="unset",this.stats.domElement.style.right="300px",this.stats.domElement.style.top="0px",document.body.appendChild(this.stats.domElement)},initGui:function(){var t=this;this.gui=new S.a,this.guiParam={animation:this.animationControl,animationSpeed:this.animationSpeed,exposure:Math.pow(this.renderer.toneMappingExposure,.25),threshold:this.bloomPass.threshold,strength:this.bloomPass.strength,radius:this.bloomPass.radius},this.gui.add(this.guiParam,"animation").onChange(function(e){t.animationControl=e}),this.gui.add(this.guiParam,"animationSpeed",1,20,1).onChange(function(e){t.animationSpeed=e}),this.gui.add(this.guiParam,"exposure",0,2,.1).onChange(function(e){t.renderer.toneMappingExposure=Math.pow(e,4)}),this.gui.add(this.guiParam,"threshold",0,1,.1).onChange(function(e){t.bloomPass.threshold=e}),this.gui.add(this.guiParam,"strength",0,4,.1).onChange(function(e){t.bloomPass.strength=e}),this.gui.add(this.guiParam,"radius",0,1,.1).onChange(function(e){t.bloomPass.radius=e})},initOrbitControls:function(){this.orbitControls.autoRotate=!0,this.orbitControls.enablePan=!0,this.orbitControls.mouseButtons={LEFT:"",MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.ROTATE},this.orbitControls.keys={LEFT:65,UP:87,RIGHT:68,BOTTOM:83},this.orbitControls.target=new THREE.Vector3(0,-3e3,0)},initObject:function(){for(var t=this,e=function(){return"rgb("+Math.round(255*Math.random())+", "+Math.round(255*Math.random())+", "+Math.round(255*Math.random())+")"},i=function(){var e=t.objectSetting.r2,i=t.objectSetting.r1,r=t.objectSetting.maxY,n=t.objectSetting.minY;return{x:(Math.floor(Math.random()*(e-i+1))+i)*(Math.random()+.2)*(Math.random()>.5?1:-1),y:Math.floor(Math.random()*(r-n+1))+n,z:(Math.floor(Math.random()*(e-i+1))+i)*(Math.random()+.2)*(Math.random()>.5?1:-1)}},r=function(){var e=t.objectSetting.r2,i=t.objectSetting.r1,r=t.objectSetting.maxY,n=t.objectSetting.minY;return{x:(Math.floor(Math.random()*(e-i+1))+i)*Math.random()*(Math.random()>.5?1:-1),y:Math.floor(Math.random()*(r-n+1))+n,z:(Math.floor(Math.random()*(e-i+1))+i)*Math.random()*(Math.random()>.5?1:-1)}},n=0;n<this.objectSetting.planeTotal;n+=1){var o=new THREE.MeshStandardMaterial({color:e(),roughness:0,metalness:0});o.wireframe=Math.random()>.1,o.transparent=!0,o.opacity=.8*Math.random();var s=Math.round(6*Math.random()),a=new THREE.PlaneBufferGeometry(Math.floor(Math.random()*(this.objectSetting.planSetting.maxWidth-this.objectSetting.planSetting.minWidth+1))+this.objectSetting.planSetting.minWidth,Math.floor(Math.random()*(this.objectSetting.planSetting.maxHeight-this.objectSetting.planSetting.minHeight+1))+this.objectSetting.planSetting.minHeight,s<2?0:s,1),l=new THREE.Mesh(a,o),h=i();l.position.set(h.x,h.y,h.z),l.lookAt(0,h.y,0),this.scene.add(l)}for(var c=0;c<this.objectSetting.sphereTotal;c+=1){var u=new THREE.MeshStandardMaterial({color:e(),roughness:0,metalness:0}),d=new THREE.SphereBufferGeometry(1,10,16,6),p=new THREE.Mesh(d,u),m=r();p.position.set(m.x,m.y,m.z);var f=this.objectSetting.sphereSetting.scaleMax,v=this.objectSetting.sphereSetting.scaleMin;p.scale.set(1,Math.floor(Math.random()*(f-v+1))+v,1),this.scene.add(p)}},animation:function(){this.camera.position.y>2e3?(this.cameraDirection=1,this.orbitControls.target=new THREE.Vector3(0,-2e3,0)):this.camera.position.y<-2e3&&(this.cameraDirection=-1,this.orbitControls.target=new THREE.Vector3(0,2e3,0)),this.camera.position.y-=this.animationSpeed*this.cameraDirection},updateRenderer:function(){var t=this.clock.getDelta();this.orbitControls.update(t),this.animationControl&&this.animation(),this.composer.render(),this.stats.update(),this.animationFrame=requestAnimationFrame(this.updateRenderer)},mousemove:function(t){this.mouse.x=event.clientX/window.innerWidth*2-1,this.mouse.y=-event.clientY/window.innerHeight*2+1},clearObjCache:function(t){t.geometry.dispose(),t.material.dispose()},clearCache:function(){var t=this;this.renderer.clear(!0,!0,!0),this.renderer.dispose(),this.renderer.forceContextLoss(),this.renderer.domElement=null,this.scene.children.forEach(function(e){"Mesh"===e.type&&t.clearObjCache(e)}),this.scene.dispose(),this.gui.destroy()},resetRenderer:function(){this.renderer.setSize(this.width,this.height),this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix()}},Object(l.b)(["resetThreeTipsFun","resetThreeLinkFun"])),created:function(){this.resetThreeTipsFun("    旋转相机：鼠标左键\n    缩放场景：鼠标滚轮\n    移动相机：鼠标右键"),this.resetThreeLinkFun("composer/unrealBloom.vue")},mounted:function(){this.init()},beforeDestroy:function(){document.body.removeChild(document.getElementById("three-stats")),this.clearCache(),window.onkeydown=null,this.renderer=null,this.scene=null,this.camera=null,this.lightBox=null,this.helperBox=null,this.objBox=null,this.clock=null,this.orbitControls=null,this.transformControls=null,this.gui=null,cancelAnimationFrame(this.animationFrame)}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"three-display three-init"},[e("div",{ref:"three-canvas",staticClass:"three-canvas",attrs:{id:"three-canvas"},on:{mousemove:this.mousemove}})])},staticRenderFns:[]};var E=i("VU/8")(T,C,!1,function(t){i("9GoY")},"data-v-0be42f99",null);e.default=E.exports},vQO2:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var r=i("Ml+6"),n=function(t,e){void 0===e&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),e=document),r.T.call(this),this.visible=!1,this.domElement=e;var i=new o;this.add(i);var n=new s;this.add(n);var a=this;O("camera",t),O("object",void 0),O("enabled",!0),O("axis",null),O("mode","translate"),O("translationSnap",null),O("rotationSnap",null),O("scaleSnap",null),O("space","world"),O("size",1),O("dragging",!1),O("showX",!0),O("showY",!0),O("showZ",!0);var l={type:"change"},h={type:"mouseDown"},c={type:"mouseUp",mode:a.mode},u={type:"objectChange"},d=new r._4,p=new r._23,m=new r._23,f=new r._1,v={X:new r._23(1,0,0),Y:new r._23(0,1,0),Z:new r._23(0,0,1)},w=new r._23,g=new r._23,b=new r._23,y=new r._23,x=new r._23,M=new r._23,S=0,T=new r._23,C=new r._1,E=new r._23,_=new r._23,P=new r._1,L=new r._1,R=new r._23,Y=new r._23,j=new r._1,z=new r._23,X=new r._23,F=new r._1,Q=new r._1,B=new r._23,Z=new r._23,I=new r._23,H=new r._1,D=new r._23;function O(t,e){var r=e;Object.defineProperty(a,t,{get:function(){return void 0!==r?r:e},set:function(e){r!==e&&(r=e,n[t]=e,i[t]=e,a.dispatchEvent({type:t+"-changed",value:e}),a.dispatchEvent(l))}}),a[t]=e,n[t]=e,i[t]=e}function U(t){if(document.pointerLockElement)return{x:0,y:0,button:t.button};var i=t.changedTouches?t.changedTouches[0]:t,r=e.getBoundingClientRect();return{x:(i.clientX-r.left)/r.width*2-1,y:-(i.clientY-r.top)/r.height*2+1,button:t.button}}function A(t){a.enabled&&a.pointerHover(U(t))}function k(t){a.enabled&&(document.addEventListener("mousemove",W,!1),a.pointerHover(U(t)),a.pointerDown(U(t)))}function W(t){a.enabled&&a.pointerMove(U(t))}function V(t){a.enabled&&(document.removeEventListener("mousemove",W,!1),a.pointerUp(U(t)))}O("worldPosition",X),O("worldPositionStart",Y),O("worldQuaternion",F),O("worldQuaternionStart",j),O("cameraPosition",T),O("cameraQuaternion",C),O("pointStart",w),O("pointEnd",g),O("rotationAxis",y),O("rotationAngle",S),O("eye",Z),e.addEventListener("mousedown",k,!1),e.addEventListener("touchstart",k,!1),e.addEventListener("mousemove",A,!1),e.addEventListener("touchmove",A,!1),e.addEventListener("touchmove",W,!1),document.addEventListener("mouseup",V,!1),e.addEventListener("touchend",V,!1),e.addEventListener("touchcancel",V,!1),e.addEventListener("touchleave",V,!1),this.dispose=function(){e.removeEventListener("mousedown",k),e.removeEventListener("touchstart",k),e.removeEventListener("mousemove",A),document.removeEventListener("mousemove",W),e.removeEventListener("touchmove",A),e.removeEventListener("touchmove",W),document.removeEventListener("mouseup",V),e.removeEventListener("touchend",V),e.removeEventListener("touchcancel",V),e.removeEventListener("touchleave",V),this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})},this.attach=function(t){return this.object=t,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),this.object.parent.matrixWorld.decompose(_,P,R),this.object.matrixWorld.decompose(X,F,B),L.copy(P).inverse(),Q.copy(F).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(T,C,E),Z.copy(T).sub(X).normalize(),r.T.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(t){if(void 0!==this.object&&!0!==this.dragging&&(void 0===t.button||0===t.button)){d.setFromCamera(t,this.camera);var e=d.intersectObjects(i.picker[this.mode].children,!0)[0]||!1;this.axis=e?e.object.name:null}},this.pointerDown=function(t){if(!(void 0===this.object||!0===this.dragging||void 0!==t.button&&0!==t.button||0!==t.button&&void 0!==t.button||null===this.axis)){d.setFromCamera(t,this.camera);var e=d.intersectObjects([n],!0)[0]||!1;if(e){var i=this.space;if("scale"===this.mode?i="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(i="world"),"local"===i&&"rotate"===this.mode){var r=this.rotationSnap;"X"===this.axis&&r&&(this.object.rotation.x=Math.round(this.object.rotation.x/r)*r),"Y"===this.axis&&r&&(this.object.rotation.y=Math.round(this.object.rotation.y/r)*r),"Z"===this.axis&&r&&(this.object.rotation.z=Math.round(this.object.rotation.z/r)*r)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),I.copy(this.object.position),H.copy(this.object.quaternion),D.copy(this.object.scale),this.object.matrixWorld.decompose(Y,j,z),w.copy(e.point).sub(Y)}this.dragging=!0,h.mode=this.mode,this.dispatchEvent(h)}},this.pointerMove=function(t){var e=this.axis,i=this.mode,r=this.object,o=this.space;if("scale"===i?o="local":"E"!==e&&"XYZE"!==e&&"XYZ"!==e||(o="world"),void 0!==r&&null!==e&&!1!==this.dragging&&(void 0===t.button||0===t.button)){d.setFromCamera(t,this.camera);var s=d.intersectObjects([n],!0)[0]||!1;if(!1!==s){if(g.copy(s.point).sub(Y),"translate"===i)b.copy(g).sub(w),"local"===o&&"XYZ"!==e&&b.applyQuaternion(Q),-1===e.indexOf("X")&&(b.x=0),-1===e.indexOf("Y")&&(b.y=0),-1===e.indexOf("Z")&&(b.z=0),"local"===o&&"XYZ"!==e?b.applyQuaternion(H).divide(R):b.applyQuaternion(L).divide(R),r.position.copy(b).add(I),this.translationSnap&&("local"===o&&(r.position.applyQuaternion(f.copy(H).inverse()),-1!==e.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(H)),"world"===o&&(r.parent&&r.position.add(p.setFromMatrixPosition(r.parent.matrixWorld)),-1!==e.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(p.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==e.search("XYZ")){var a=g.length()/w.length();g.dot(w)<0&&(a*=-1),m.set(a,a,a)}else p.copy(w),m.copy(g),p.applyQuaternion(Q),m.applyQuaternion(Q),m.divide(p),-1===e.search("X")&&(m.x=1),-1===e.search("Y")&&(m.y=1),-1===e.search("Z")&&(m.z=1);r.scale.copy(D).multiply(m),this.scaleSnap&&(-1!==e.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){b.copy(g).sub(w);var h=20/X.distanceTo(p.setFromMatrixPosition(this.camera.matrixWorld));"E"===e?(y.copy(Z),S=g.angleTo(w),x.copy(w).normalize(),M.copy(g).normalize(),S*=M.cross(x).dot(Z)<0?1:-1):"XYZE"===e?(y.copy(b).cross(Z).normalize(),S=b.dot(p.copy(y).cross(this.eye))*h):"X"!==e&&"Y"!==e&&"Z"!==e||(y.copy(v[e]),p.copy(v[e]),"local"===o&&p.applyQuaternion(F),S=b.dot(p.cross(Z).normalize())*h),this.rotationSnap&&(S=Math.round(S/this.rotationSnap)*this.rotationSnap),this.rotationAngle=S,"local"===o&&"E"!==e&&"XYZE"!==e?(r.quaternion.copy(H),r.quaternion.multiply(f.setFromAxisAngle(y,S)).normalize()):(y.applyQuaternion(L),r.quaternion.copy(f.setFromAxisAngle(y,S)),r.quaternion.multiply(H).normalize())}this.dispatchEvent(l),this.dispatchEvent(u)}}},this.pointerUp=function(t){void 0!==t.button&&0!==t.button||(this.dragging&&null!==this.axis&&(c.mode=this.mode,this.dispatchEvent(c)),this.dragging=!1,void 0===t.button&&(this.axis=null))},this.getMode=function(){return a.mode},this.setMode=function(t){a.mode=t},this.setTranslationSnap=function(t){a.translationSnap=t},this.setRotationSnap=function(t){a.rotationSnap=t},this.setScaleSnap=function(t){a.scaleSnap=t},this.setSize=function(t){a.size=t},this.setSpace=function(t){a.space=t},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};n.prototype=Object.assign(Object.create(r.T.prototype),{constructor:n,isTransformControls:!0});var o=function(){r.T.call(this),this.type="TransformControlsGizmo";var t=new r.M({depthTest:!1,depthWrite:!1,transparent:!0,side:r.r,fog:!1}),e=new r.D({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),i=t.clone();i.opacity=.15;var n=t.clone();n.opacity=.33;var o=t.clone();o.color.set(16711680);var s=t.clone();s.color.set(65280);var a=t.clone();a.color.set(255);var l=t.clone();l.opacity=.25;var h=l.clone();h.color.set(16776960);var c=l.clone();c.color.set(65535);var u=l.clone();u.color.set(16711935),t.clone().color.set(16776960);var d=e.clone();d.color.set(16711680);var p=e.clone();p.color.set(65280);var m=e.clone();m.color.set(255);var f=e.clone();f.color.set(65535);var v=e.clone();v.color.set(16711935);var w=e.clone();w.color.set(16776960);var g=e.clone();g.color.set(7895160);var b=w.clone();b.opacity=.25;var y=new r.o(0,.05,.2,12,1,!1),x=new r.g(.125,.125,.125),M=new r.i;M.setAttribute("position",new r.w([0,0,0,1,0,0],3));var S,T=function(t,e){for(var i=new r.i,n=[],o=0;o<=64*e;++o)n.push(0,Math.cos(o/32*Math.PI)*t,Math.sin(o/32*Math.PI)*t);return i.setAttribute("position",new r.w(n,3)),i},C={X:[[new r.L(y,o),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new r.L(y,o),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new r.C(M,d)]],Y:[[new r.L(y,s),[0,1,0],null,null,"fwd"],[new r.L(y,s),[0,1,0],[Math.PI,0,0],null,"bwd"],[new r.C(M,p),null,[0,0,Math.PI/2]]],Z:[[new r.L(y,a),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new r.L(y,a),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new r.C(M,m),null,[0,-Math.PI/2,0]]],XYZ:[[new r.L(new r.U(.1,0),l.clone()),[0,0,0],[0,0,0]]],XY:[[new r.L(new r.Y(.295,.295),h.clone()),[.15,.15,0]],[new r.C(M,w),[.18,.3,0],null,[.125,1,1]],[new r.C(M,w),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new r.L(new r.Y(.295,.295),c.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new r.C(M,f),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new r.C(M,f),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new r.L(new r.Y(.295,.295),u.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new r.C(M,v),[.18,0,.3],null,[.125,1,1]],[new r.C(M,v),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},E={X:[[new r.L(new r.o(.2,0,1,4,1,!1),i),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new r.L(new r.o(.2,0,1,4,1,!1),i),[0,.6,0]]],Z:[[new r.L(new r.o(.2,0,1,4,1,!1),i),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new r.L(new r.U(.2,0),i)]],XY:[[new r.L(new r.Y(.4,.4),i),[.2,.2,0]]],YZ:[[new r.L(new r.Y(.4,.4),i),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new r.L(new r.Y(.4,.4),i),[.2,0,.2],[-Math.PI/2,0,0]]]},_={START:[[new r.L(new r.U(.01,2),n),null,null,null,"helper"]],END:[[new r.L(new r.U(.01,2),n),null,null,null,"helper"]],DELTA:[[new r.C((S=new r.i,S.setAttribute("position",new r.w([0,0,0,1,1,1],3)),S),n),null,null,null,"helper"]],X:[[new r.C(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new r.C(M,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new r.C(M,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},P={X:[[new r.C(T(1,.5),d)],[new r.L(new r.U(.04,0),o),[0,0,.99],null,[1,3,1]]],Y:[[new r.C(T(1,.5),p),null,[0,0,-Math.PI/2]],[new r.L(new r.U(.04,0),s),[0,0,.99],null,[3,1,1]]],Z:[[new r.C(T(1,.5),m),null,[0,Math.PI/2,0]],[new r.L(new r.U(.04,0),a),[.99,0,0],null,[1,3,1]]],E:[[new r.C(T(1.25,1),b),null,[0,Math.PI/2,0]],[new r.L(new r.o(.03,0,.15,4,1,!1),b),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new r.L(new r.o(.03,0,.15,4,1,!1),b),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new r.L(new r.o(.03,0,.15,4,1,!1),b),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new r.L(new r.o(.03,0,.15,4,1,!1),b),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new r.C(T(1,1),g),null,[0,Math.PI/2,0]]]},L={AXIS:[[new r.C(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},R={X:[[new r.L(new r._17(1,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new r.L(new r._17(1,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new r.L(new r._17(1,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new r.L(new r._17(1.25,.1,2,24),i)]],XYZE:[[new r.L(new r._10(.7,10,8),i)]]},Y={X:[[new r.L(x,o),[.8,0,0],[0,0,-Math.PI/2]],[new r.C(M,d),null,null,[.8,1,1]]],Y:[[new r.L(x,s),[0,.8,0]],[new r.C(M,p),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new r.L(x,a),[0,0,.8],[Math.PI/2,0,0]],[new r.C(M,m),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new r.L(x,h),[.85,.85,0],null,[2,2,.2]],[new r.C(M,w),[.855,.98,0],null,[.125,1,1]],[new r.C(M,w),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new r.L(x,c),[0,.85,.85],null,[.2,2,2]],[new r.C(M,f),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new r.C(M,f),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new r.L(x,u),[.85,0,.85],null,[2,.2,2]],[new r.C(M,v),[.855,0,.98],null,[.125,1,1]],[new r.C(M,v),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new r.L(new r.g(.125,.125,.125),l.clone()),[1.1,0,0]]],XYZY:[[new r.L(new r.g(.125,.125,.125),l.clone()),[0,1.1,0]]],XYZZ:[[new r.L(new r.g(.125,.125,.125),l.clone()),[0,0,1.1]]]},j={X:[[new r.L(new r.o(.2,0,.8,4,1,!1),i),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new r.L(new r.o(.2,0,.8,4,1,!1),i),[0,.5,0]]],Z:[[new r.L(new r.o(.2,0,.8,4,1,!1),i),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new r.L(x,i),[.85,.85,0],null,[3,3,.2]]],YZ:[[new r.L(x,i),[0,.85,.85],null,[.2,3,3]]],XZ:[[new r.L(x,i),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new r.L(new r.g(.2,.2,.2),i),[1.1,0,0]]],XYZY:[[new r.L(new r.g(.2,.2,.2),i),[0,1.1,0]]],XYZZ:[[new r.L(new r.g(.2,.2,.2),i),[0,0,1.1]]]},z={X:[[new r.C(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new r.C(M,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new r.C(M,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},X=function(t){var e=new r.T;for(var i in t)for(var n=t[i].length;n--;){var o=t[i][n][0].clone(),s=t[i][n][1],a=t[i][n][2],l=t[i][n][3],h=t[i][n][4];o.name=i,o.tag=h,s&&o.position.set(s[0],s[1],s[2]),a&&o.rotation.set(a[0],a[1],a[2]),l&&o.scale.set(l[0],l[1],l[2]),o.updateMatrix();var c=o.geometry.clone();c.applyMatrix4(o.matrix),o.geometry=c,o.renderOrder=1/0,o.position.set(0,0,0),o.rotation.set(0,0,0),o.scale.set(1,1,1),e.add(o)}return e},F=new r._23(0,0,0),Q=new r.t,B=new r._23(0,1,0),Z=new r._23(0,0,0),I=new r.K,H=new r._1,D=new r._1,O=new r._1,U=new r._23(1,0,0),A=new r._23(0,1,0),k=new r._23(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=X(C)),this.add(this.gizmo.rotate=X(P)),this.add(this.gizmo.scale=X(Y)),this.add(this.picker.translate=X(E)),this.add(this.picker.rotate=X(R)),this.add(this.picker.scale=X(j)),this.add(this.helper.translate=X(_)),this.add(this.helper.rotate=X(L)),this.add(this.helper.scale=X(z)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var t=this.space;"scale"===this.mode&&(t="local");var e="local"===t?this.worldQuaternion:O;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var i=[];i=(i=(i=i.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var n=0;n<i.length;n++){var o=i[n];o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition);var s=this.worldPosition.distanceTo(this.cameraPosition);if(o.scale.set(1,1,1).multiplyScalar(s*this.size/7),"helper"!==o.tag){if(o.quaternion.copy(e),"translate"===this.mode||"scale"===this.mode){"X"!==o.name&&"XYZX"!==o.name||Math.abs(B.copy(U).applyQuaternion(e).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"!==o.name&&"XYZY"!==o.name||Math.abs(B.copy(A).applyQuaternion(e).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"!==o.name&&"XYZZ"!==o.name||Math.abs(B.copy(k).applyQuaternion(e).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(B.copy(k).applyQuaternion(e).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(B.copy(U).applyQuaternion(e).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(B.copy(A).applyQuaternion(e).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),-1!==o.name.search("X")&&(B.copy(U).applyQuaternion(e).dot(this.eye)<0?"fwd"===o.tag?o.visible=!1:o.scale.x*=-1:"bwd"===o.tag&&(o.visible=!1)),-1!==o.name.search("Y")&&(B.copy(A).applyQuaternion(e).dot(this.eye)<0?"fwd"===o.tag?o.visible=!1:o.scale.y*=-1:"bwd"===o.tag&&(o.visible=!1)),-1!==o.name.search("Z")&&(B.copy(k).applyQuaternion(e).dot(this.eye)<0?"fwd"===o.tag?o.visible=!1:o.scale.z*=-1:"bwd"===o.tag&&(o.visible=!1))}else"rotate"===this.mode&&(D.copy(e),B.copy(this.eye).applyQuaternion(H.copy(e).inverse()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(I.lookAt(this.eye,Z,A)),"X"===o.name&&(H.setFromAxisAngle(U,Math.atan2(-B.y,B.z)),H.multiplyQuaternions(D,H),o.quaternion.copy(H)),"Y"===o.name&&(H.setFromAxisAngle(A,Math.atan2(B.x,B.z)),H.multiplyQuaternions(D,H),o.quaternion.copy(H)),"Z"===o.name&&(H.setFromAxisAngle(k,Math.atan2(B.y,B.x)),H.multiplyQuaternions(D,H),o.quaternion.copy(H)));o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._opacity=o.material._opacity||o.material.opacity,o.material._color=o.material._color||o.material.color.clone(),o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled?this.axis&&(o.name===this.axis?(o.material.opacity=1,o.material.color.lerp(new r.l(1,1,1),.5)):this.axis.split("").some(function(t){return o.name===t})?(o.material.opacity=1,o.material.color.lerp(new r.l(1,1,1),.5)):(o.material.opacity*=.25,o.material.color.lerp(new r.l(1,1,1),.5))):(o.material.opacity*=.5,o.material.color.lerp(new r.l(1,1,1),.5))}else o.visible=!1,"AXIS"===o.name?(o.position.copy(this.worldPositionStart),o.visible=!!this.axis,"X"===this.axis&&(H.setFromEuler(Q.set(0,0,0)),o.quaternion.copy(e).multiply(H),Math.abs(B.copy(U).applyQuaternion(e).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(H.setFromEuler(Q.set(0,0,Math.PI/2)),o.quaternion.copy(e).multiply(H),Math.abs(B.copy(A).applyQuaternion(e).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(H.setFromEuler(Q.set(0,Math.PI/2,0)),o.quaternion.copy(e).multiply(H),Math.abs(B.copy(k).applyQuaternion(e).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(H.setFromEuler(Q.set(0,Math.PI/2,0)),B.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(I.lookAt(Z,B,A)),o.quaternion.multiply(H),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),F.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),F.applyQuaternion(this.worldQuaternionStart.clone().inverse()),o.scale.copy(F),o.visible=this.dragging):(o.quaternion.copy(e),this.dragging?o.position.copy(this.worldPositionStart):o.position.copy(this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name)))}r.T.prototype.updateMatrixWorld.call(this)}};o.prototype=Object.assign(Object.create(r.T.prototype),{constructor:o,isTransformControlsGizmo:!0});var s=function(){r.L.call(this,new r.Y(1e5,1e5,2,2),new r.M({visible:!1,wireframe:!0,side:r.r,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var t=new r._23(1,0,0),e=new r._23(0,1,0),i=new r._23(0,0,1),n=new r._23,o=new r._23,s=new r._23,a=new r.K,l=new r._1;this.updateMatrixWorld=function(){var h=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(h="local"),t.set(1,0,0).applyQuaternion("local"===h?this.worldQuaternion:l),e.set(0,1,0).applyQuaternion("local"===h?this.worldQuaternion:l),i.set(0,0,1).applyQuaternion("local"===h?this.worldQuaternion:l),s.copy(e),this.mode){case"translate":case"scale":switch(this.axis){case"X":s.copy(this.eye).cross(t),o.copy(t).cross(s);break;case"Y":s.copy(this.eye).cross(e),o.copy(e).cross(s);break;case"Z":s.copy(this.eye).cross(i),o.copy(i).cross(s);break;case"XY":o.copy(i);break;case"YZ":o.copy(t);break;case"XZ":s.copy(i),o.copy(e);break;case"XYZ":case"E":o.set(0,0,0)}break;case"rotate":default:o.set(0,0,0)}0===o.length()?this.quaternion.copy(this.cameraQuaternion):(a.lookAt(n.set(0,0,0),o,s),this.quaternion.setFromRotationMatrix(a)),r.T.prototype.updateMatrixWorld.call(this)}};s.prototype=Object.assign(Object.create(r.L.prototype),{constructor:s,isTransformControlsPlane:!0})}});